// In /api/create-block.ts
const {
  data: { user },
} = await supabase.auth.getUser(req.headers.authorization?.replace('Bearer ', ''));

if (!user) return res.status(401).json({ error: 'Unauthorized' });

const { data, error } = await supabase
  .from('blocks')
  .insert({
    owner_id: user.id,
    title, message, lat, lon, emoji
  });
